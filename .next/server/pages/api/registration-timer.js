"use strict";(()=>{var e={};e.id=684,e.ids=[684],e.modules={1159:(e,r,t)=>{t.r(r),t.d(r,{config:()=>l,default:()=>d,routeModule:()=>c});var i={};t.r(i),t.d(i,{default:()=>u});var s=t(3480),n=t(8667),o=t(6435),a=t(1853);async function u(e,r){if("GET"===e.method)try{let e=await a.z.registrationTimer.findFirst({orderBy:{createdAt:"desc"}});r.status(200).json({timer:e})}catch(e){console.error("Error fetching registration timer:",e),r.status(500).json({error:"Internal server error"})}else if("POST"===e.method)try{let{registrationDate:t,userId:i}=e.body;if(!t)return r.status(400).json({error:"Registration date is required"});if(!i)return r.status(400).json({error:"User ID is required"});let s=await a.z.user.findUnique({where:{id:i}});if(!s||!s.isAdmin)return r.status(403).json({error:"Admin access required"});let n=new Date(t);if(isNaN(n.getTime()))return r.status(400).json({error:"Invalid date format"});let o=await a.z.registrationTimer.create({data:{registrationDate:n,createdBy:i}});r.status(200).json({timer:o})}catch(e){console.error("Error creating registration timer:",e),r.status(500).json({error:"Internal server error"})}else if("PUT"===e.method)try{let{id:t,registrationDate:i,userId:s}=e.body;if(!t)return r.status(400).json({error:"Timer ID is required"});if(!i)return r.status(400).json({error:"Registration date is required"});if(!s)return r.status(400).json({error:"User ID is required"});let n=await a.z.user.findUnique({where:{id:s}});if(!n||!n.isAdmin)return r.status(403).json({error:"Admin access required"});let o=new Date(i);if(isNaN(o.getTime()))return r.status(400).json({error:"Invalid date format"});let u=await a.z.registrationTimer.update({where:{id:t},data:{registrationDate:o,createdBy:s}});r.status(200).json({timer:u})}catch(e){console.error("Error updating registration timer:",e),"P2025"===e.code?r.status(404).json({error:"Timer not found"}):r.status(500).json({error:"Internal server error"})}else if("DELETE"===e.method)try{let{id:t,userId:i}=e.body;if(!t)return r.status(400).json({error:"Timer ID is required"});if(!i)return r.status(400).json({error:"User ID is required"});let s=await a.z.user.findUnique({where:{id:i}});if(!s||!s.isAdmin)return r.status(403).json({error:"Admin access required"});await a.z.registrationTimer.delete({where:{id:t}}),r.status(200).json({message:"Timer deleted successfully"})}catch(e){console.error("Error deleting registration timer:",e),"P2025"===e.code?r.status(404).json({error:"Timer not found"}):r.status(500).json({error:"Internal server error"})}else r.setHeader("Allow",["GET","POST","PUT","DELETE"]),r.status(405).json({error:`Method ${e.method} not allowed`})}let d=(0,o.M)(i,"default"),l=(0,o.M)(i,"config"),c=new s.PagesAPIRouteModule({definition:{kind:n.A.PAGES_API,page:"/api/registration-timer",pathname:"/api/registration-timer",bundlePath:"",filename:""},userland:i})},1853:(e,r,t)=>{t.d(r,{z:()=>s});var i=t(6330);let s=globalThis.prisma??new i.PrismaClient},3480:(e,r,t)=>{e.exports=t(5600)},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6330:e=>{e.exports=require("@prisma/client")},6435:(e,r)=>{Object.defineProperty(r,"M",{enumerable:!0,get:function(){return function e(r,t){return t in r?r[t]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,t)):"function"==typeof r&&"default"===t?r:void 0}}})},8667:(e,r)=>{Object.defineProperty(r,"A",{enumerable:!0,get:function(){return t}});var t=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})}};var r=require("../../webpack-api-runtime.js");r.C(e);var t=r(r.s=1159);module.exports=t})();